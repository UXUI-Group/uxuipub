name: Deploy to GitHub Pages

# ì›Œí¬í”Œë¡œìš°ê°€ ì–¸ì œ ì‹¤í–‰ë ì§€ ì •ì˜
on:
  push:
    branches: [main] # main ë¸Œëœì¹˜ì— í‘¸ì‹œë  ë•Œ ì‹¤í–‰
  workflow_dispatch: # GitHub ì›¹ì—ì„œ ìˆ˜ë™ìœ¼ë¡œ ì‹¤í–‰ ê°€ëŠ¥

# ì‹¤í–‰í•  ì‘ì—…ë“¤ ì •ì˜
jobs:
  build-and-deploy:
    runs-on: ubuntu-latest # Ubuntu ìµœì‹  ë²„ì „ì—ì„œ ì‹¤í–‰

    steps:
      # 1. ì €ì¥ì†Œ ì½”ë“œë¥¼ ê°€ì ¸ì˜¤ê¸°
      - name: Checkout ğŸ›ï¸
        uses: actions/checkout@v3 # checkout ì•¡ì…˜ì˜ v3 ë²„ì „ ì‚¬ìš© (ì•ˆì •ì )

      # 2. Node.js í™˜ê²½ ì„¤ì •
      - name: Setup Node.js âš™ï¸
        uses: actions/setup-node@v3 # setup-node ì•¡ì…˜ì˜ v3 ë²„ì „ ì‚¬ìš©
        with:
          node-version: '18' # Node.js 18 ë²„ì „ ì‚¬ìš©

      # 3. PNPM íŒ¨í‚¤ì§€ ë§¤ë‹ˆì € ì„¤ì •
      - name: Setup PNPM âš™ï¸
        uses: pnpm/action-setup@v2 # pnpm-setup ì•¡ì…˜ì˜ v2 ë²„ì „ ì‚¬ìš©
        with:
          version: 8 # PNPM 8 ë²„ì „ ì‚¬ìš©

      # 4. ì˜ì¡´ì„± íŒ¨í‚¤ì§€ ì„¤ì¹˜
      - name: Install dependencies ğŸ“¦
        run: pnpm install

      # 5. í”„ë¡œì íŠ¸ ë¹Œë“œ ë° GitHub Pages ì¤€ë¹„
      - name: Build ğŸ”§
        run: |
          pnpm build  # Next.js í”„ë¡œì íŠ¸ ë¹Œë“œ
          touch out/.nojekyll  # GitHub Pagesì—ì„œ Jekyll ì²˜ë¦¬ ë°©ì§€

      # 6. GitHub Pagesì— ë°°í¬
      - name: Deploy ğŸš€
        uses: JamesIves/github-pages-deploy-action@v4 # ë°°í¬ ì•¡ì…˜ì˜ v4 ë²„ì „ ì‚¬ìš© (ìµœì‹ )
        with:
          folder: out # ë°°í¬í•  í´ë” (Next.js ì •ì  ì¶œë ¥ë¬¼)
          branch: gh-pages # ë°°í¬ë  ë¸Œëœì¹˜ëª…
